# Multithreaded P2P Server
# 4/17/21
# Cooper Myers
# CIS 457 Data Communications

import socket
import threading
import sys
import os
import struct
import time


# Beginning Message to Server
print ("\nFTP server is running.\n\nTo begin, connect a client.\n")

# Storing Server Data Information
server_ip = 'localhost'
server_port = 2309
BUFFER_SIZE = 1024

# Creating Server Socket, Binding, then Listening
server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
server_socket.bind((server_ip, server_port))

server_socket.listen()
print("The Server is ready to recieve!")

def command_menu(connection_socket):
    
    while True:
           print ("\n\nWaiting for instruction")
           data = connection_socket.recv(BUFFER_SIZE).decode('utf-8')
      
           # Print Requested Command to Screen
           print ("\nRecieved instruction: {}".format(data))
    
           # If Command Matches go to Following Helper Method
           if data == "RETR":
               retr()            
               
           elif data == "QUIT":
               quit()
       
       
def quit():
    # Close the server
    connection_socket.close()
    print("Successfully disconnected from client")
    return


while True:
    connection_socket, addr = server_socket.accept()
    threading.Thread(target=command_menu, args=(connection_socket,)).start()
